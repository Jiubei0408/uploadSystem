{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}
    title
{% endblock %}

{% block navbar %}
    <nav class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse"
                        data-target="#nav-bar">
                    <span class="sr-only">切换导航</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">信息统计系统</a>
            </div>
            <div class="collapse navbar-collapse" id="nav-bar">
                <ul class="nav navbar-nav">
                    <li><a href="/">首页</a></li>
                    <li><a href={{ url_for('main.lists') }}>列表</a></li>
                    {% if user and user.permission == 1 %}
                        <li><a href={{ url_for('main.admin') }}>管理员</a></li>
                    {% endif %}
                </ul>
                <ul class="nav navbar-nav navbar-right" style="margin-right: 15px">
                    {% if user and user.nickname %}
                        <form id="logout" method="post" action="/session/logout"></form>
                        <li>
                            <a style="padding: 10px">你好，{{ user.nickname }}&nbsp;&nbsp;
                                <button type="submit" class="glyphicon glyphicon-log-in btn btn-default btn-sm"
                                        style="top: 0" onclick="$('#logout').submit()">&nbsp;登出
                                </button>
                            </a>
                        </li>
                    {% else %}
                        <li>
                            <button class="glyphicon glyphicon-log-in btn btn-default btn-sm" style="margin-top: 10px;"
                                    onclick="window.location = '{{ url_for('main.login') }}'; ">
                                登录
                            </button>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
{% endblock %}

{% block content %}
    <div class="container">
        {% block page_content %}
        {% endblock %}
    </div>
    {% block footer %}
        <footer class="container-fluid panel-footer"
                style="position: fixed; bottom: 0; left: 0; right: 0; z-index: -100">
            <div style="text-align: right; font-size: 15px; margin-right: 30px">
                Develop by jiubei
            </div>
        </footer>
    {% endblock %}
{% endblock %}

{% block scripts %}
    <link href="{{ bootstrap_find_resource('css/bootstrap.css', cdn='bootstrap') }}" rel="stylesheet"/>
    <script src="{{ bootstrap_find_resource('jquery.js', cdn='jquery') }}"></script>
    <script src="{{ bootstrap_find_resource('js/bootstrap.js', cdn='bootstrap') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery.toast.js') }}"></script>
    <link href="{{ url_for('static', filename='css/jquery.toast.css') }}" rel="stylesheet"/>
    <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet"/>
    {#  显示flash_message  #}
    <script>
        {% block flash_message %}
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        $.toast({
                            heading: '{{ message }}',
                            position: 'top-center',
                            loader: false,
                            icon: '{{ category }}'
                        });
                    {% endfor %}
                {% endif %}
            {% endwith %}
        {% endblock %}
    </script>
{% endblock %}
